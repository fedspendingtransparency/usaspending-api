--create index fabs_unique_id on transaction_fabs_new (afa_generated_unique);
--create index fpds_unique_id on transaction_fpds_new (detached_award_proc_unique);
--create index tx_unique_id on transaction_normalized_new (transaction_unique_id);
--
--UPDATE transaction_fabs_new
--SET transaction_id = tn_new.id
--FROM transaction_normalized_new AS tn_new
--WHERE tn_new.transaction_unique_id = transaction_fabs_new.afa_generated_unique;
--
--UPDATE transaction_fpds_new
--SET transaction_id = tn_new.id
--FROM transaction_normalized_new AS tn_new
--WHERE tn_new.transaction_unique_id = transaction_fpds_new.detached_award_proc_unique;
--
CREATE TABLE transaction_fabs_new_2 AS (
    SELECT
        transaction_normalized_new.id as transaction_id,
        transaction_fabs_new.published_award_financial_assistance_id AS published_award_financial_assistance_id,
        transaction_fabs_new.action_date AS action_date,
        transaction_fabs_new.action_type AS action_type,
        transaction_fabs_new.assistance_type AS assistance_type,
        transaction_fabs_new.award_description AS award_description,
        transaction_fabs_new.awardee_or_recipient_legal AS awardee_or_recipient_legal,
        transaction_fabs_new.awardee_or_recipient_uniqu AS awardee_or_recipient_uniqu,
        transaction_fabs_new.awarding_agency_code AS awarding_agency_code,
        transaction_fabs_new.awarding_office_code AS awarding_office_code,
        transaction_fabs_new.awarding_sub_tier_agency_c AS awarding_sub_tier_agency_c,
        transaction_fabs_new.award_modification_amendme AS award_modification_amendme,
        transaction_fabs_new.business_funds_indicator AS business_funds_indicator,
        transaction_fabs_new.business_types AS business_types,
        transaction_fabs_new.cfda_number AS cfda_number,
        transaction_fabs_new.correction_late_delete_ind AS correction_late_delete_ind,
        transaction_fabs_new.face_value_loan_guarantee AS face_value_loan_guarantee,
        transaction_fabs_new.fain AS fain,
        transaction_fabs_new.federal_action_obligation AS federal_action_obligation,
        transaction_fabs_new.fiscal_year_and_quarter_co AS fiscal_year_and_quarter_co,
        transaction_fabs_new.funding_agency_code AS funding_agency_code,
        transaction_fabs_new.funding_office_code AS funding_office_code,
        transaction_fabs_new.funding_sub_tier_agency_co AS funding_sub_tier_agency_co,
        transaction_fabs_new.legal_entity_address_line1 AS legal_entity_address_line1,
        transaction_fabs_new.legal_entity_address_line2 AS legal_entity_address_line2,
        transaction_fabs_new.legal_entity_address_line3 AS legal_entity_address_line3,
        transaction_fabs_new.legal_entity_country_code AS legal_entity_country_code,
        transaction_fabs_new.legal_entity_foreign_city AS legal_entity_foreign_city,
        transaction_fabs_new.legal_entity_foreign_posta AS legal_entity_foreign_posta,
        transaction_fabs_new.legal_entity_foreign_provi AS legal_entity_foreign_provi,
        transaction_fabs_new.legal_entity_zip5 AS legal_entity_zip5,
        transaction_fabs_new.legal_entity_zip_last4 AS legal_entity_zip_last4,
        transaction_fabs_new.non_federal_funding_amount AS non_federal_funding_amount,
        transaction_fabs_new.original_loan_subsidy_cost AS original_loan_subsidy_cost,
        transaction_fabs_new.period_of_performance_curr AS period_of_performance_curr,
        transaction_fabs_new.period_of_performance_star AS period_of_performance_star,
        transaction_fabs_new.place_of_performance_code AS place_of_performance_code,
        transaction_fabs_new.place_of_performance_congr AS place_of_performance_congr,
        transaction_fabs_new.place_of_perform_country_c AS place_of_perform_country_c,
        transaction_fabs_new.place_of_performance_forei AS place_of_performance_forei,
        transaction_fabs_new.place_of_performance_zip4a AS place_of_performance_zip4a,
        transaction_fabs_new.record_type AS record_type,
        transaction_fabs_new.sai_number AS sai_number,
        transaction_fabs_new.uri AS uri,
        transaction_fabs_new.legal_entity_congressional AS legal_entity_congressional,
        transaction_fabs_new.total_funding_amount AS total_funding_amount,
        transaction_fabs_new.cfda_title AS cfda_title,
        transaction_fabs_new.awarding_agency_name AS awarding_agency_name,
        transaction_fabs_new.awarding_sub_tier_agency_n AS awarding_sub_tier_agency_n,
        transaction_fabs_new.funding_agency_name AS funding_agency_name,
        transaction_fabs_new.funding_sub_tier_agency_na AS funding_sub_tier_agency_na,
        transaction_fabs_new.is_historical AS is_historical,
        transaction_fabs_new.place_of_perform_county_na AS place_of_perform_county_na,
        transaction_fabs_new.place_of_perform_state_nam AS place_of_perform_state_nam,
        transaction_fabs_new.place_of_performance_city AS place_of_performance_city,
        transaction_fabs_new.legal_entity_city_name AS legal_entity_city_name,
        transaction_fabs_new.legal_entity_county_code AS legal_entity_county_code,
        transaction_fabs_new.legal_entity_county_name AS legal_entity_county_name,
        transaction_fabs_new.legal_entity_state_code AS legal_entity_state_code,
        transaction_fabs_new.legal_entity_state_name AS legal_entity_state_name,
        transaction_fabs_new.modified_at AS modified_at,
        transaction_fabs_new.afa_generated_unique AS afa_generated_unique,
        transaction_fabs_new.is_active AS is_active,
        transaction_fabs_new.legal_entity_country_name AS legal_entity_country_name,
        transaction_fabs_new.place_of_perform_country_n AS place_of_perform_country_n,
        transaction_fabs_new.place_of_perform_county_co AS place_of_perform_county_co,
        transaction_fabs_new.awarding_office_name AS awarding_office_name,
        transaction_fabs_new.funding_office_name AS funding_office_name,
        transaction_fabs_new.legal_entity_city_code AS legal_entity_city_code,
        transaction_fabs_new.legal_entity_foreign_descr AS legal_entity_foreign_descr,
        transaction_fabs_new.submission_id AS submission_id,
        transaction_fabs_new.place_of_perfor_state_code AS place_of_perfor_state_code,
        transaction_fabs_new.place_of_performance_zip5 AS place_of_performance_zip5,
        transaction_fabs_new.place_of_perform_zip_last4 AS place_of_perform_zip_last4,
        transaction_fabs_new.created_at AS created_at,
        transaction_fabs_new.updated_at AS updated_at
    FROM
        transaction_fabs_new
        INNER JOIN
        transaction_normalized_new ON transaction_normalized_new.transaction_unique_id = transaction_fabs_new.afa_generated_unique
);

CREATE TABLE transaction_fpds_new_2 AS (
    SELECT
        transaction_normalized_new.id as transaction_id,
        transaction_fpds_new.detached_award_procurement_id AS detached_award_procurement_id,
        transaction_fpds_new.detached_award_proc_unique AS detached_award_proc_unique,
        transaction_fpds_new.piid AS piid,
        transaction_fpds_new.agency_id AS agency_id,
        transaction_fpds_new.awarding_sub_tier_agency_c AS awarding_sub_tier_agency_c,
        transaction_fpds_new.awarding_sub_tier_agency_n AS awarding_sub_tier_agency_n,
        transaction_fpds_new.awarding_agency_code AS awarding_agency_code,
        transaction_fpds_new.awarding_agency_name AS awarding_agency_name,
        transaction_fpds_new.parent_award_id AS parent_award_id,
        transaction_fpds_new.award_modification_amendme AS award_modification_amendme,
        transaction_fpds_new.type_of_contract_pricing AS type_of_contract_pricing,
        transaction_fpds_new.type_of_contract_pric_desc AS type_of_contract_pric_desc,
        transaction_fpds_new.contract_award_type AS contract_award_type,
        transaction_fpds_new.contract_award_type_desc AS contract_award_type_desc,
        transaction_fpds_new.naics AS naics,
        transaction_fpds_new.naics_description AS naics_description,
        transaction_fpds_new.awardee_or_recipient_uniqu AS awardee_or_recipient_uniqu,
        transaction_fpds_new.ultimate_parent_legal_enti AS ultimate_parent_legal_enti,
        transaction_fpds_new.ultimate_parent_unique_ide AS ultimate_parent_unique_ide,
        transaction_fpds_new.award_description AS award_description,
        transaction_fpds_new.place_of_performance_zip4a AS place_of_performance_zip4a,
        transaction_fpds_new.place_of_performance_zip5 AS place_of_performance_zip5,
        transaction_fpds_new.place_of_perform_zip_last4 AS place_of_perform_zip_last4,
        transaction_fpds_new.place_of_perform_city_name AS place_of_perform_city_name,
        transaction_fpds_new.place_of_perform_county_co AS place_of_perform_county_co,
        transaction_fpds_new.place_of_perform_county_na AS place_of_perform_county_na,
        transaction_fpds_new.place_of_performance_congr AS place_of_performance_congr,
        transaction_fpds_new.awardee_or_recipient_legal AS awardee_or_recipient_legal,
        transaction_fpds_new.legal_entity_city_name AS legal_entity_city_name,
        transaction_fpds_new.legal_entity_county_code AS legal_entity_county_code,
        transaction_fpds_new.legal_entity_county_name AS legal_entity_county_name,
        transaction_fpds_new.legal_entity_state_code AS legal_entity_state_code,
        transaction_fpds_new.legal_entity_state_descrip AS legal_entity_state_descrip,
        transaction_fpds_new.legal_entity_zip4 AS legal_entity_zip4,
        transaction_fpds_new.legal_entity_zip5 AS legal_entity_zip5,
        transaction_fpds_new.legal_entity_zip_last4 AS legal_entity_zip_last4,
        transaction_fpds_new.legal_entity_congressional AS legal_entity_congressional,
        transaction_fpds_new.legal_entity_address_line1 AS legal_entity_address_line1,
        transaction_fpds_new.legal_entity_address_line2 AS legal_entity_address_line2,
        transaction_fpds_new.legal_entity_address_line3 AS legal_entity_address_line3,
        transaction_fpds_new.legal_entity_country_code AS legal_entity_country_code,
        transaction_fpds_new.legal_entity_country_name AS legal_entity_country_name,
        transaction_fpds_new.period_of_performance_star AS period_of_performance_star,
        transaction_fpds_new.period_of_performance_curr AS period_of_performance_curr,
        transaction_fpds_new.period_of_perf_potential_e AS period_of_perf_potential_e,
        transaction_fpds_new.ordering_period_end_date AS ordering_period_end_date,
        transaction_fpds_new.action_date AS action_date,
        transaction_fpds_new.action_type AS action_type,
        transaction_fpds_new.action_type_description AS action_type_description,
        transaction_fpds_new.federal_action_obligation AS federal_action_obligation,
        transaction_fpds_new.current_total_value_award AS current_total_value_award,
        transaction_fpds_new.potential_total_value_awar AS potential_total_value_awar,
        transaction_fpds_new.total_obligated_amount AS total_obligated_amount,
        transaction_fpds_new.base_exercised_options_val AS base_exercised_options_val,
        transaction_fpds_new.base_and_all_options_value AS base_and_all_options_value,
        transaction_fpds_new.funding_sub_tier_agency_co AS funding_sub_tier_agency_co,
        transaction_fpds_new.funding_sub_tier_agency_na AS funding_sub_tier_agency_na,
        transaction_fpds_new.funding_office_code AS funding_office_code,
        transaction_fpds_new.funding_office_name AS funding_office_name,
        transaction_fpds_new.awarding_office_code AS awarding_office_code,
        transaction_fpds_new.awarding_office_name AS awarding_office_name,
        transaction_fpds_new.referenced_idv_agency_iden AS referenced_idv_agency_iden,
        transaction_fpds_new.referenced_idv_agency_desc AS referenced_idv_agency_desc,
        transaction_fpds_new.funding_agency_code AS funding_agency_code,
        transaction_fpds_new.funding_agency_name AS funding_agency_name,
        transaction_fpds_new.place_of_performance_locat AS place_of_performance_locat,
        transaction_fpds_new.place_of_performance_state AS place_of_performance_state,
        transaction_fpds_new.place_of_perfor_state_desc AS place_of_perfor_state_desc,
        transaction_fpds_new.place_of_perform_country_c AS place_of_perform_country_c,
        transaction_fpds_new.place_of_perf_country_desc AS place_of_perf_country_desc,
        transaction_fpds_new.idv_type AS idv_type,
        transaction_fpds_new.idv_type_description AS idv_type_description,
        transaction_fpds_new.referenced_idv_type AS referenced_idv_type,
        transaction_fpds_new.referenced_idv_type_desc AS referenced_idv_type_desc,
        transaction_fpds_new.vendor_doing_as_business_n AS vendor_doing_as_business_n,
        transaction_fpds_new.vendor_phone_number AS vendor_phone_number,
        transaction_fpds_new.vendor_fax_number AS vendor_fax_number,
        transaction_fpds_new.multiple_or_single_award_i AS multiple_or_single_award_i,
        transaction_fpds_new.multiple_or_single_aw_desc AS multiple_or_single_aw_desc,
        transaction_fpds_new.referenced_mult_or_single AS referenced_mult_or_single,
        transaction_fpds_new.referenced_mult_or_si_desc AS referenced_mult_or_si_desc,
        transaction_fpds_new.type_of_idc AS type_of_idc,
        transaction_fpds_new.type_of_idc_description AS type_of_idc_description,
        transaction_fpds_new.a_76_fair_act_action AS a_76_fair_act_action,
        transaction_fpds_new.a_76_fair_act_action_desc AS a_76_fair_act_action_desc,
        transaction_fpds_new.dod_claimant_program_code AS dod_claimant_program_code,
        transaction_fpds_new.dod_claimant_prog_cod_desc AS dod_claimant_prog_cod_desc,
        transaction_fpds_new.clinger_cohen_act_planning AS clinger_cohen_act_planning,
        transaction_fpds_new.clinger_cohen_act_pla_desc AS clinger_cohen_act_pla_desc,
        transaction_fpds_new.commercial_item_acquisitio AS commercial_item_acquisitio,
        transaction_fpds_new.commercial_item_acqui_desc AS commercial_item_acqui_desc,
        transaction_fpds_new.commercial_item_test_progr AS commercial_item_test_progr,
        transaction_fpds_new.commercial_item_test_desc AS commercial_item_test_desc,
        transaction_fpds_new.consolidated_contract AS consolidated_contract,
        transaction_fpds_new.consolidated_contract_desc AS consolidated_contract_desc,
        transaction_fpds_new.contingency_humanitarian_o AS contingency_humanitarian_o,
        transaction_fpds_new.contingency_humanitar_desc AS contingency_humanitar_desc,
        transaction_fpds_new.contract_bundling AS contract_bundling,
        transaction_fpds_new.contract_bundling_descrip AS contract_bundling_descrip,
        transaction_fpds_new.contract_financing AS contract_financing,
        transaction_fpds_new.contract_financing_descrip AS contract_financing_descrip,
        transaction_fpds_new.contracting_officers_deter AS contracting_officers_deter,
        transaction_fpds_new.contracting_officers_desc AS contracting_officers_desc,
        transaction_fpds_new.cost_accounting_standards AS cost_accounting_standards,
        transaction_fpds_new.cost_accounting_stand_desc AS cost_accounting_stand_desc,
        transaction_fpds_new.cost_or_pricing_data AS cost_or_pricing_data,
        transaction_fpds_new.cost_or_pricing_data_desc AS cost_or_pricing_data_desc,
        transaction_fpds_new.country_of_product_or_serv AS country_of_product_or_serv,
        transaction_fpds_new.country_of_product_or_desc AS country_of_product_or_desc,
        transaction_fpds_new.davis_bacon_act AS davis_bacon_act,
        transaction_fpds_new.davis_bacon_act_descrip AS davis_bacon_act_descrip,
        transaction_fpds_new.evaluated_preference AS evaluated_preference,
        transaction_fpds_new.evaluated_preference_desc AS evaluated_preference_desc,
        transaction_fpds_new.extent_competed AS extent_competed,
        transaction_fpds_new.extent_compete_description AS extent_compete_description,
        transaction_fpds_new.fed_biz_opps AS fed_biz_opps,
        transaction_fpds_new.fed_biz_opps_description AS fed_biz_opps_description,
        transaction_fpds_new.foreign_funding AS foreign_funding,
        transaction_fpds_new.foreign_funding_desc AS foreign_funding_desc,
        transaction_fpds_new.government_furnished_equip AS government_furnished_equip,
        transaction_fpds_new.government_furnished_desc AS government_furnished_desc,
        transaction_fpds_new.information_technology_com AS information_technology_com,
        transaction_fpds_new.information_technolog_desc AS information_technolog_desc,
        transaction_fpds_new.interagency_contracting_au AS interagency_contracting_au,
        transaction_fpds_new.interagency_contract_desc AS interagency_contract_desc,
        transaction_fpds_new.local_area_set_aside AS local_area_set_aside,
        transaction_fpds_new.local_area_set_aside_desc AS local_area_set_aside_desc,
        transaction_fpds_new.major_program AS major_program,
        transaction_fpds_new.purchase_card_as_payment_m AS purchase_card_as_payment_m,
        transaction_fpds_new.purchase_card_as_paym_desc AS purchase_card_as_paym_desc,
        transaction_fpds_new.multi_year_contract AS multi_year_contract,
        transaction_fpds_new.multi_year_contract_desc AS multi_year_contract_desc,
        transaction_fpds_new.national_interest_action AS national_interest_action,
        transaction_fpds_new.national_interest_desc AS national_interest_desc,
        transaction_fpds_new.number_of_actions AS number_of_actions,
        transaction_fpds_new.number_of_offers_received AS number_of_offers_received,
        transaction_fpds_new.other_statutory_authority AS other_statutory_authority,
        transaction_fpds_new.performance_based_service AS performance_based_service,
        transaction_fpds_new.performance_based_se_desc AS performance_based_se_desc,
        transaction_fpds_new.place_of_manufacture AS place_of_manufacture,
        transaction_fpds_new.place_of_manufacture_desc AS place_of_manufacture_desc,
        transaction_fpds_new.price_evaluation_adjustmen AS price_evaluation_adjustmen,
        transaction_fpds_new.product_or_service_code AS product_or_service_code,
        transaction_fpds_new.product_or_service_co_desc AS product_or_service_co_desc,
        transaction_fpds_new.program_acronym AS program_acronym,
        transaction_fpds_new.other_than_full_and_open_c AS other_than_full_and_open_c,
        transaction_fpds_new.other_than_full_and_o_desc AS other_than_full_and_o_desc,
        transaction_fpds_new.recovered_materials_sustai AS recovered_materials_sustai,
        transaction_fpds_new.recovered_materials_s_desc AS recovered_materials_s_desc,
        transaction_fpds_new.research AS research,
        transaction_fpds_new.research_description AS research_description,
        transaction_fpds_new.sea_transportation AS sea_transportation,
        transaction_fpds_new.sea_transportation_desc AS sea_transportation_desc,
        transaction_fpds_new.service_contract_act AS service_contract_act,
        transaction_fpds_new.service_contract_act_desc AS service_contract_act_desc,
        transaction_fpds_new.small_business_competitive AS small_business_competitive,
        transaction_fpds_new.solicitation_identifier AS solicitation_identifier,
        transaction_fpds_new.solicitation_procedures AS solicitation_procedures,
        transaction_fpds_new.solicitation_procedur_desc AS solicitation_procedur_desc,
        transaction_fpds_new.fair_opportunity_limited_s AS fair_opportunity_limited_s,
        transaction_fpds_new.fair_opportunity_limi_desc AS fair_opportunity_limi_desc,
        transaction_fpds_new.subcontracting_plan AS subcontracting_plan,
        transaction_fpds_new.subcontracting_plan_desc AS subcontracting_plan_desc,
        transaction_fpds_new.program_system_or_equipmen AS program_system_or_equipmen,
        transaction_fpds_new.program_system_or_equ_desc AS program_system_or_equ_desc,
        transaction_fpds_new.type_set_aside AS type_set_aside,
        transaction_fpds_new.type_set_aside_description AS type_set_aside_description,
        transaction_fpds_new.epa_designated_product AS epa_designated_product,
        transaction_fpds_new.epa_designated_produc_desc AS epa_designated_produc_desc,
        transaction_fpds_new.walsh_healey_act AS walsh_healey_act,
        transaction_fpds_new.walsh_healey_act_descrip AS walsh_healey_act_descrip,
        transaction_fpds_new.transaction_number AS transaction_number,
        transaction_fpds_new.sam_exception AS sam_exception,
        transaction_fpds_new.sam_exception_description AS sam_exception_description,
        transaction_fpds_new.city_local_government AS city_local_government,
        transaction_fpds_new.county_local_government AS county_local_government,
        transaction_fpds_new.inter_municipal_local_gove AS inter_municipal_local_gove,
        transaction_fpds_new.local_government_owned AS local_government_owned,
        transaction_fpds_new.municipality_local_governm AS municipality_local_governm,
        transaction_fpds_new.school_district_local_gove AS school_district_local_gove,
        transaction_fpds_new.township_local_government AS township_local_government,
        transaction_fpds_new.us_state_government AS us_state_government,
        transaction_fpds_new.us_federal_government AS us_federal_government,
        transaction_fpds_new.federal_agency AS federal_agency,
        transaction_fpds_new.federally_funded_research AS federally_funded_research,
        transaction_fpds_new.us_tribal_government AS us_tribal_government,
        transaction_fpds_new.foreign_government AS foreign_government,
        transaction_fpds_new.community_developed_corpor AS community_developed_corpor,
        transaction_fpds_new.labor_surplus_area_firm AS labor_surplus_area_firm,
        transaction_fpds_new.corporate_entity_not_tax_e AS corporate_entity_not_tax_e,
        transaction_fpds_new.corporate_entity_tax_exemp AS corporate_entity_tax_exemp,
        transaction_fpds_new.partnership_or_limited_lia AS partnership_or_limited_lia,
        transaction_fpds_new.sole_proprietorship AS sole_proprietorship,
        transaction_fpds_new.small_agricultural_coopera AS small_agricultural_coopera,
        transaction_fpds_new.international_organization AS international_organization,
        transaction_fpds_new.us_government_entity AS us_government_entity,
        transaction_fpds_new.emerging_small_business AS emerging_small_business,
        transaction_fpds_new.c8a_program_participant AS c8a_program_participant,
        transaction_fpds_new.sba_certified_8_a_joint_ve AS sba_certified_8_a_joint_ve,
        transaction_fpds_new.dot_certified_disadvantage AS dot_certified_disadvantage,
        transaction_fpds_new.self_certified_small_disad AS self_certified_small_disad,
        transaction_fpds_new.historically_underutilized AS historically_underutilized,
        transaction_fpds_new.small_disadvantaged_busine AS small_disadvantaged_busine,
        transaction_fpds_new.the_ability_one_program AS the_ability_one_program,
        transaction_fpds_new.historically_black_college AS historically_black_college,
        transaction_fpds_new.c1862_land_grant_college AS c1862_land_grant_college,
        transaction_fpds_new.c1890_land_grant_college AS c1890_land_grant_college,
        transaction_fpds_new.c1994_land_grant_college AS c1994_land_grant_college,
        transaction_fpds_new.minority_institution AS minority_institution,
        transaction_fpds_new.private_university_or_coll AS private_university_or_coll,
        transaction_fpds_new.school_of_forestry AS school_of_forestry,
        transaction_fpds_new.state_controlled_instituti AS state_controlled_instituti,
        transaction_fpds_new.tribal_college AS tribal_college,
        transaction_fpds_new.veterinary_college AS veterinary_college,
        transaction_fpds_new.educational_institution AS educational_institution,
        transaction_fpds_new.alaskan_native_servicing_i AS alaskan_native_servicing_i,
        transaction_fpds_new.community_development_corp AS community_development_corp,
        transaction_fpds_new.native_hawaiian_servicing AS native_hawaiian_servicing,
        transaction_fpds_new.domestic_shelter AS domestic_shelter,
        transaction_fpds_new.manufacturer_of_goods AS manufacturer_of_goods,
        transaction_fpds_new.hospital_flag AS hospital_flag,
        transaction_fpds_new.veterinary_hospital AS veterinary_hospital,
        transaction_fpds_new.hispanic_servicing_institu AS hispanic_servicing_institu,
        transaction_fpds_new.foundation AS foundation,
        transaction_fpds_new.woman_owned_business AS woman_owned_business,
        transaction_fpds_new.minority_owned_business AS minority_owned_business,
        transaction_fpds_new.women_owned_small_business AS women_owned_small_business,
        transaction_fpds_new.economically_disadvantaged AS economically_disadvantaged,
        transaction_fpds_new.joint_venture_women_owned AS joint_venture_women_owned,
        transaction_fpds_new.joint_venture_economically AS joint_venture_economically,
        transaction_fpds_new.veteran_owned_business AS veteran_owned_business,
        transaction_fpds_new.service_disabled_veteran_o AS service_disabled_veteran_o,
        transaction_fpds_new.contracts AS contracts,
        transaction_fpds_new.grants AS grants,
        transaction_fpds_new.receives_contracts_and_gra AS receives_contracts_and_gra,
        transaction_fpds_new.airport_authority AS airport_authority,
        transaction_fpds_new.council_of_governments AS council_of_governments,
        transaction_fpds_new.housing_authorities_public AS housing_authorities_public,
        transaction_fpds_new.interstate_entity AS interstate_entity,
        transaction_fpds_new.planning_commission AS planning_commission,
        transaction_fpds_new.port_authority AS port_authority,
        transaction_fpds_new.transit_authority AS transit_authority,
        transaction_fpds_new.subchapter_s_corporation AS subchapter_s_corporation,
        transaction_fpds_new.limited_liability_corporat AS limited_liability_corporat,
        transaction_fpds_new.foreign_owned_and_located AS foreign_owned_and_located,
        transaction_fpds_new.american_indian_owned_busi AS american_indian_owned_busi,
        transaction_fpds_new.alaskan_native_owned_corpo AS alaskan_native_owned_corpo,
        transaction_fpds_new.indian_tribe_federally_rec AS indian_tribe_federally_rec,
        transaction_fpds_new.native_hawaiian_owned_busi AS native_hawaiian_owned_busi,
        transaction_fpds_new.tribally_owned_business AS tribally_owned_business,
        transaction_fpds_new.asian_pacific_american_own AS asian_pacific_american_own,
        transaction_fpds_new.black_american_owned_busin AS black_american_owned_busin,
        transaction_fpds_new.hispanic_american_owned_bu AS hispanic_american_owned_bu,
        transaction_fpds_new.native_american_owned_busi AS native_american_owned_busi,
        transaction_fpds_new.subcontinent_asian_asian_i AS subcontinent_asian_asian_i,
        transaction_fpds_new.other_minority_owned_busin AS other_minority_owned_busin,
        transaction_fpds_new.for_profit_organization AS for_profit_organization,
        transaction_fpds_new.nonprofit_organization AS nonprofit_organization,
        transaction_fpds_new.other_not_for_profit_organ AS other_not_for_profit_organ,
        transaction_fpds_new.us_local_government AS us_local_government,
        transaction_fpds_new.referenced_idv_modificatio AS referenced_idv_modificatio,
        transaction_fpds_new.undefinitized_action AS undefinitized_action,
        transaction_fpds_new.undefinitized_action_desc AS undefinitized_action_desc,
        transaction_fpds_new.domestic_or_foreign_entity AS domestic_or_foreign_entity,
        transaction_fpds_new.domestic_or_foreign_e_desc AS domestic_or_foreign_e_desc,
        transaction_fpds_new.annual_revenue AS annual_revenue,
        transaction_fpds_new.division_name AS division_name,
        transaction_fpds_new.division_number_or_office AS division_number_or_office,
        transaction_fpds_new.number_of_employees AS number_of_employees,
        transaction_fpds_new.vendor_alternate_name AS vendor_alternate_name,
        transaction_fpds_new.vendor_alternate_site_code AS vendor_alternate_site_code,
        transaction_fpds_new.vendor_enabled AS vendor_enabled,
        transaction_fpds_new.vendor_legal_org_name AS vendor_legal_org_name,
        transaction_fpds_new.vendor_location_disabled_f AS vendor_location_disabled_f,
        transaction_fpds_new.vendor_site_code AS vendor_site_code,
        transaction_fpds_new.pulled_from AS pulled_from,
        transaction_fpds_new.last_modified AS last_modified,
        transaction_fpds_new.initial_report_date AS initial_report_date,
        transaction_fpds_new.referenced_idv_agency_name AS referenced_idv_agency_name,
        transaction_fpds_new.referenced_multi_or_single AS referenced_multi_or_single,
        transaction_fpds_new.award_or_idv_flag AS award_or_idv_flag,
        transaction_fpds_new.place_of_perform_country_n AS place_of_perform_country_n,
        transaction_fpds_new.place_of_perform_state_nam AS place_of_perform_state_nam,
        transaction_fpds_new.created_at AS created_at,
        transaction_fpds_new.updated_at AS updated_at
    FROM
        transaction_fpds_new
        INNER JOIN
        transaction_normalized_new ON transaction_normalized_new.transaction_unique_id = transaction_fpds_new.detached_award_proc_unique
);

TRUNCATE transaction_fabs_new, transaction_fpds_new;
DROP TABLE transaction_fabs_new;
DROP TABLE transaction_fpds_new;

ALTER TABLE transaction_fabs_new_2 RENAME TO transaction_fabs_new;
ALTER TABLE transaction_fpds_new_2 RENAME TO transaction_fpds_new;
--
--UPDATE transaction_fabs_new
--SET transaction_id = (SELECT id FROM transaction_normalized_new WHERE transaction_normalized_new.transaction_unique_id = transaction_fabs_new.afa_generated_unique);
--
--UPDATE transaction_fpds_new
--SET transaction_id = (SELECT id FROM transaction_normalized_new WHERE transaction_normalized_new.transaction_unique_id = transaction_fpds_new.detached_award_proc_unique);