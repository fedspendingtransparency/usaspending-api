{
  "final_name": "universal_transaction_matview",
  "matview_sql": [
    "SELECT",
    "  UPPER(CONCAT(\"legal_entity\".\"recipient_name\", ' ', \"transaction_fpds\".\"naics\", ' ', \"naics\".\"description\", ' ', \"psc\".\"description\")) AS keyword_string,",
    "  UPPER(CONCAT(awards.piid, ' ', awards.fain, ' ', awards.uri)) AS award_id_string,",
    "  \"transaction_normalized\".\"action_date\"::date,",
    "  \"transaction_normalized\".\"fiscal_year\",",
    "  \"transaction_normalized\".\"type\",",
    "  \"transaction_normalized\".\"action_type\",",
    "  \"transaction_normalized\".\"award_id\",",
    "  \"awards\".\"category\" AS award_category,",
    "  \"awards\".\"total_obligation\",",
    "  obligation_to_enum(\"awards\".\"total_obligation\") AS total_obl_bin,",
    "  \"awards\".\"fain\",",
    "  \"awards\".\"uri\",",
    "  \"awards\".\"piid\",",
    "  \"transaction_normalized\".\"federal_action_obligation\",",
    "  \"transaction_normalized\".\"description\" AS transaction_description,",
    "",
    "  place_of_performance.\"location_country_code\" AS pop_country_code,",
    "  place_of_performance.\"country_name\" AS pop_country_name,",
    "  place_of_performance.\"state_code\" AS pop_state_code,",
    "  place_of_performance.\"county_code\" AS pop_county_code,",
    "  place_of_performance.\"zip5\" AS pop_zip5,",
    "  place_of_performance.\"congressional_code\" AS pop_congressional_code,",
    "",
    "  recipient_location.\"location_country_code\" AS recipient_location_country_code,",
    "  recipient_location.\"country_name\" AS recipient_location_country_name,",
    "  recipient_location.\"state_code\" AS recipient_location_state_code,",
    "  recipient_location.\"county_code\" AS recipient_location_county_code,",
    "  recipient_location.\"zip5\" AS recipient_location_zip5,",
    "  recipient_location.\"congressional_code\" AS recipient_location_congressional_code,",
    "",
    "  \"transaction_fpds\".\"naics\" AS naics_code,",
    "  \"naics\".\"description\" AS naics_description,",
    "  \"transaction_fpds\".\"product_or_service_code\",",
    "  \"psc\".\"description\" AS product_or_service_description,",
    "  \"transaction_fpds\".\"pulled_from\",",
    "  \"transaction_fpds\".\"type_of_contract_pricing\",",
    "  \"transaction_fpds\".\"type_set_aside\",",
    "  \"transaction_fpds\".\"extent_competed\",",
    "  \"transaction_fabs\".\"cfda_number\",",
    "  \"references_cfda\".\"program_title\" AS cfda_title,",
    "  \"references_cfda\".\"popular_name\" AS cfda_popular_name,",
    "  \"transaction_normalized\".\"recipient_id\",",
    "  UPPER(\"legal_entity\".\"recipient_name\") AS recipient_name,",
    "  \"legal_entity\".\"recipient_unique_id\",",
    "  \"legal_entity\".\"parent_recipient_unique_id\",",
    "  \"legal_entity\".\"business_categories\",",
    "",
    "  TAA.\"name\" AS awarding_toptier_agency_name,",
    "  TFA.\"name\" AS funding_toptier_agency_name,",
    "  SAA.\"name\" AS awarding_subtier_agency_name,",
    "  SFA.\"name\" AS funding_subtier_agency_name,",
    "  TAA.\"abbreviation\" AS awarding_toptier_agency_abbreviation,",
    "  TFA.\"abbreviation\" AS funding_toptier_agency_abbreviation,",
    "  SAA.\"abbreviation\" AS awarding_subtier_agency_abbreviation,",
    "  SFA.\"abbreviation\" AS funding_subtier_agency_abbreviation",
    "FROM",
    "  \"transaction_normalized\"",
    "LEFT OUTER JOIN",
    "  \"transaction_fabs\" ON (\"transaction_normalized\".\"id\" = \"transaction_fabs\".\"transaction_id\")",
    "LEFT OUTER JOIN",
    "  \"transaction_fpds\" ON (\"transaction_normalized\".\"id\" = \"transaction_fpds\".\"transaction_id\")",
    "LEFT OUTER JOIN",
    "  \"references_cfda\" ON (\"transaction_fabs\".\"cfda_number\" = \"references_cfda\".\"program_number\")",
    "LEFT OUTER JOIN",
    "  \"legal_entity\" ON (\"transaction_normalized\".\"recipient_id\" = \"legal_entity\".\"legal_entity_id\")",
    "LEFT OUTER JOIN",
    "  \"references_location\" AS recipient_location ON (\"legal_entity\".\"location_id\" = recipient_location.\"location_id\")",
    "LEFT OUTER JOIN",
    "  \"awards\" ON (\"transaction_normalized\".\"award_id\" = \"awards\".\"id\")",
    "LEFT OUTER JOIN",
    "  \"references_location\" AS place_of_performance ON (\"transaction_normalized\".\"place_of_performance_id\" = place_of_performance.\"location_id\")",
    "LEFT OUTER JOIN",
    "  \"agency\" AS AA ON (\"transaction_normalized\".\"awarding_agency_id\" = AA.\"id\")",
    "LEFT OUTER JOIN",
    "  \"toptier_agency\" AS TAA ON (AA.\"toptier_agency_id\" = TAA.\"toptier_agency_id\")",
    "LEFT OUTER JOIN",
    "  \"subtier_agency\" AS SAA ON (AA.\"subtier_agency_id\" = SAA.\"subtier_agency_id\")",
    "LEFT OUTER JOIN",
    "  \"agency\" AS FA ON (\"transaction_normalized\".\"funding_agency_id\" = FA.\"id\")",
    "LEFT OUTER JOIN",
    "  \"toptier_agency\" AS TFA ON (FA.\"toptier_agency_id\" = TFA.\"toptier_agency_id\")",
    "LEFT OUTER JOIN",
    "  \"subtier_agency\" AS SFA ON (FA.\"subtier_agency_id\" = SFA.\"subtier_agency_id\")",
    "LEFT OUTER JOIN",
    "  \"naics\" ON (\"transaction_fpds\".\"naics\" = \"naics\".\"code\")",
    "LEFT OUTER JOIN",
    "  \"psc\" ON (\"transaction_fpds\".\"product_or_service_code\" = \"psc\".\"code\")",
    "WHERE",
    "  \"transaction_normalized\".\"action_date\" >= '2007-10-01' AND",
    "  \"transaction_normalized\".\"federal_action_obligation\" IS NOT NULL",
    "ORDER BY",
    "  \"transaction_normalized\".\"action_date\" DESC"
  ],
  "indexes": [
    {
      "name": "action_date",
      "columns": [{"name": "\"action_date\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "fiscal_year",
      "columns": [{"name": "\"fiscal_year\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "type",
      "where": "\"type\" IS NOT NULL",
      "columns": [{"name": "\"type\""}]
    }, {
      "name": "ordered_type",
      "columns": [{"name": "\"type\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "action_type",
      "columns": [{"name": "\"action_type\""}]
    }, {
      "name": "award_id",
      "columns": [{"name": "\"award_id\""}]
    }, {
      "name": "award_category",
      "where": "\"award_category\" IS NOT NULL",
      "columns": [{"name": "\"award_category\""}]
    }, {
      "name": "total_obligation",
      "where": "\"total_obligation\" IS NOT NULL",
      "columns": [{"name": "\"total_obligation\""}]
    }, {
      "name": "ordered_total_obligation",
      "columns": [{"name": "\"total_obligation\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "total_obl_bin",
      "columns": [{"name": "\"total_obl_bin\""}]
    }, {
      "name": "pop_country_code",
      "where": "\"pop_country_code\" IS NOT NULL",
      "columns": [{"name": "\"pop_country_code\""}]
    }, {
      "name": "pop_state_code",
      "where": "\"pop_state_code\" IS NOT NULL",
      "columns": [{"name": "\"pop_state_code\""}]
    }, {
      "name": "pop_county_code",
      "where": "\"pop_county_code\" IS NOT NULL",
      "columns": [{"name": "\"pop_county_code\""}]
    }, {
      "name": "pop_zip5",
      "where": "\"pop_zip5\" IS NOT NULL",
      "columns": [{"name": "\"pop_zip5\""}]
    }, {
      "name": "pop_congressional_code",
      "where": "\"pop_congressional_code\" IS NOT NULL",
      "columns": [{"name": "\"pop_congressional_code\""}]
    }, {
      "name": "gin_recipient_name",
      "method": "GIN",
      "columns": [{"name": "\"recipient_name\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "gin_recipient_unique_id",
      "method": "GIN",
      "columns": [{"name": "\"recipient_unique_id\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "gin_parent_recipient_unique_id",
      "method": "GIN",
      "columns": [{"name": "\"parent_recipient_unique_id\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "recipient_id",
      "where": "\"recipient_id\" IS NOT NULL",
      "columns": [{"name": "\"recipient_id\""}]
    }, {
      "name": "recipient_name",
      "where": "\"recipient_name\" IS NOT NULL",
      "columns": [{"name": "\"recipient_name\""}]
    }, {
      "name": "recipient_unique_id",
      "where": "\"recipient_unique_id\" IS NOT NULL",
      "columns": [{"name": "\"recipient_unique_id\""}]
    }, {
      "name": "parent_recipient_unique_id",
      "where": "\"parent_recipient_unique_id\" IS NOT NULL",
      "columns": [{"name": "\"parent_recipient_unique_id\""}]
    }, {
      "name": "awarding_toptier_agency_name",
      "where": "awarding_toptier_agency_name IS NOT NULL",
      "columns": [{"name": "\"awarding_toptier_agency_name\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "awarding_subtier_agency_name",
      "where": "awarding_subtier_agency_name IS NOT NULL",
      "columns": [{"name": "\"awarding_subtier_agency_name\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "funding_toptier_agency_name",
      "where": "funding_toptier_agency_name IS NOT NULL",
      "columns": [{"name": "\"funding_toptier_agency_name\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "funding_subtier_agency_name",
      "where": "funding_subtier_agency_name IS NOT NULL",
      "columns": [{"name": "\"funding_subtier_agency_name\"", "order": "DESC NULLS LAST"}]
    }, {
      "name": "gin_awarding_toptier_agency_name",
      "method": "GIN",
      "columns": [{"name": "\"awarding_toptier_agency_name\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "gin_awarding_subtier_agency_name",
      "method": "GIN",
      "columns": [{"name": "\"awarding_subtier_agency_name\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "gin_funding_toptier_agency_name",
      "method": "GIN",
      "columns": [{"name": "\"funding_toptier_agency_name\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "gin_funding_subtier_agency_name",
      "method": "GIN",
      "columns": [{"name": "\"funding_subtier_agency_name\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "recipient_location_country_code",
      "where": "\"recipient_location_country_code\" IS NOT NULL",
      "columns": [{"name": "\"recipient_location_country_code\""}]
    }, {
      "name": "recipient_location_state_code",
      "where": "\"recipient_location_state_code\" IS NOT NULL",
      "columns": [{"name": "\"recipient_location_state_code\""}]
    }, {
      "name": "recipient_location_county_code",
      "where": "\"recipient_location_county_code\" IS NOT NULL",
      "columns": [{"name": "\"recipient_location_county_code\""}]
    }, {
      "name": "recipient_location_zip5",
      "where": "\"recipient_location_zip5\" IS NOT NULL",
      "columns": [{"name": "\"recipient_location_zip5\""}]
    }, {
      "name": "recipient_location_congressional_code",
      "where": "\"recipient_location_congressional_code\" IS NOT NULL",
      "columns": [{"name": "\"recipient_location_congressional_code\""}]
    }, {
      "name": "cfda_multi",
      "where": "\"cfda_number\" IS NOT NULL",
      "columns": [
        {"name": "\"cfda_number\""},
        {"name": "\"cfda_title\""}
      ]
    }, {
      "name": "pulled_from",
      "where": "\"pulled_from\" IS NOT NULL",
      "columns": [{"name": "\"pulled_from\""}]
    }, {
      "name": "type_of_contract_pricing",
      "where": "\"type_of_contract_pricing\" IS NOT NULL",
      "columns": [{"name": "\"type_of_contract_pricing\""}]
    }, {
      "name": "extent_competed",
      "where": "\"extent_competed\" IS NOT NULL",
      "columns": [{"name": "\"extent_competed\""}]
    }, {
      "name": "type_set_aside",
      "where": "\"type_set_aside\" IS NOT NULL",
      "columns": [{"name": "\"type_set_aside\""}]
    }, {
      "name": "product_or_service_code",
      "where": "\"product_or_service_code\" IS NOT NULL",
      "columns": [{"name": "\"product_or_service_code\""}]
    }, {
      "name": "gin_naics_code",
      "method": "GIN",
      "columns": [{"name": "\"naics_code\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "naics_code",
      "where": "\"naics_code\" IS NOT NULL",
      "columns": [{"name": "\"naics_code\""}]
    }, {
      "name": "business_categories",
      "method": "GIN",
      "columns": [{"name": "\"business_categories\""}]
    }, {
      "name": "keyword_string",
      "method": "GIN",
      "columns": [{"name": "\"keyword_string\"", "opclass": "gin_trgm_ops"}]
    }, {
      "name": "award_id_string",
      "method": "GIN",
      "columns": [{"name": "\"award_id_string\"", "opclass": "gin_trgm_ops"}]
     }, {
      "name": "tuned_type_and_idv",
      "where": "\"award_type\" IS NULL AND \"pulled_from\" IS NOT NULL",
      "columns": [{"name": "\"award_type\""}, {"name": "\"pulled_from\""}]
     }
  ]
}




